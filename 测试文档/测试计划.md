# 电厂污染物排放预测系统 - API与前端连接测试计划

## 测试目的

本测试计划旨在验证电厂污染物排放预测系统的API接口与前端页面之间的连接是否正常，确保数据能够正确展示和交互。通过测试，我们可以确认：

1. API服务是否正常运行
2. 前端页面能否正确访问
3. 前端页面与API的数据交互是否正常
4. 用户交互功能是否能够正确响应

## 测试环境要求

- Python 3.8+
- FastAPI和相关依赖已安装（见requirements.txt）
- 现代浏览器（Chrome, Firefox, Edge等）
- 网络连接（本地测试）

## 测试工具

我们提供了两个测试脚本：

1. `test_api_connection.py` - Python脚本，用于测试API接口和前端页面的可访问性
2. `test_frontend_api.js` - JavaScript脚本，用于在浏览器控制台中测试前端与API的交互

## 测试步骤

### 1. 启动API服务

```bash
python api.py
```

服务应该会在http://localhost:8000启动。

### 2. 运行API连接测试

```bash
python test_api_connection.py
```

这个脚本会测试：
- 健康检查API
- 排放数据API
- 排放预测API
- 自然语言查询API
- 前端页面是否可访问

### 3. 运行前端API交互测试

1. 在浏览器中打开系统页面（http://localhost:8000）
2. 打开浏览器开发者工具（F12或右键"检查"）
3. 切换到"控制台"(Console)选项卡
4. 将`test_frontend_api.js`中的代码复制到控制台中
5. 按回车键运行测试
6. 查看测试结果

此测试会检查：
- 前端页面是否能成功调用API
- DOM元素是否正确加载
- API返回的数据是否能被正确处理

### 4. 手动测试关键功能

除了自动化测试外，还应该手动测试以下关键功能：

#### 首页
- 检查实时数据概览是否显示
- 验证机组排放状态表格是否加载数据

#### 数据看板
- 检查指标概览是否显示
- 点击"刷新数据"按钮，验证数据是否更新
- 切换污染物类型，验证图表是否更新
- 切换机组，验证详情表格是否更新

#### 排放预测
- 点击"加载当前数据"按钮，验证是否能获取当前数据
- 填写特征数据并点击"开始预测"按钮，验证是否显示预测结果
- 切换预测时间段，验证图表是否更新

#### 自然语言查询
- 输入查询语句并提交，验证是否返回答案
- 检查查询历史是否保存

#### 语音识别
- 尝试录制语音（如果浏览器支持）并验证转文字功能
- 提交语音查询，验证是否返回结果

## 测试结果记录

每次测试后，应记录以下信息：

1. 测试日期和时间
2. 测试环境（操作系统、浏览器版本等）
3. 测试结果（通过/失败）
4. 如有失败的测试，记录详细错误信息和复现步骤
5. 截图或录屏（如适用）

## 常见问题排查

### API服务无法启动
- 检查是否已安装所有依赖：`pip install -r requirements.txt`
- 检查端口8000是否被占用：`netstat -ano | findstr 8000`（Windows）或 `lsof -i:8000`（Linux）
- 检查错误日志

### 无法连接到API
- 确认API服务已启动
- 确认浏览器访问的是正确的URL
- 检查网络连接
- 检查浏览器控制台是否有跨域(CORS)错误

### 数据不显示
- 检查浏览器控制台是否有JavaScript错误
- 检查网络请求选项卡中的API请求是否成功
- 验证API返回的数据格式是否符合预期

## 测试完成标准

所有测试项目通过，且没有发现严重或中等级别的问题时，可视为测试完成。

## 报告模板

```
# API与前端连接测试报告

## 测试信息
- 测试日期：[日期]
- 测试人员：[姓名]
- 测试环境：[环境描述]

## 自动化测试结果
- API连接测试：[通过/失败]
- 前端API交互测试：[通过/失败]

## 手动测试结果
- 首页功能：[通过/失败]
- 数据看板功能：[通过/失败]
- 排放预测功能：[通过/失败]
- 自然语言查询功能：[通过/失败]
- 语音识别功能：[通过/失败]

## 发现的问题
1. [问题描述]
   - 严重程度：[低/中/高]
   - 复现步骤：[步骤]
   - 预期结果：[预期]
   - 实际结果：[实际]

## 建议
- [改进建议]

## 结论
[总体评价] 