# 电厂污染物排放预测系统 - 测试执行指南

## 1. 概述

本文档提供了电厂污染物排放预测系统测试的详细执行指南，包括功能测试、性能测试和用户体验测试的步骤和方法。通过按照本指南进行测试，可以全面评估系统的质量和性能。

## 2. 测试环境准备

### 2.1 硬件要求

- **服务器要求**：
  - CPU: 4核以上
  - 内存: 8GB以上
  - 磁盘空间: 50GB以上
  - 网络: 千兆网络
  
- **客户端要求**：
  - CPU: 双核以上
  - 内存: 4GB以上
  - 显示器分辨率: 1920x1080以上

### 2.2 软件要求

- **服务器端**：
  - Docker: 19.03+
  - Docker Compose: 1.27+
  - Python 3.8+ (测试脚本运行环境)
  
- **客户端**：
  - 现代浏览器: Chrome 90+, Firefox 88+, Edge 90+
  - Python 3.8+ (测试脚本运行环境)
  - 必要的Python库: requests, matplotlib, pandas, numpy, tqdm, psutil
  
### 2.3 环境搭建步骤

1. **安装Docker和Docker Compose**：
   ```bash
   # 安装Docker (Ubuntu示例)
   curl -fsSL https://get.docker.com -o get-docker.sh
   sudo sh get-docker.sh
   
   # 安装Docker Compose
   sudo curl -L "https://github.com/docker/compose/releases/download/1.29.2/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
   sudo chmod +x /usr/local/bin/docker-compose
   ```

2. **克隆代码仓库（如适用）**：
   ```bash
   git clone <repository-url>
   cd <repository-directory>
   ```

3. **安装测试依赖**：
   ```bash
   pip install requests matplotlib pandas numpy tqdm psutil
   ```

4. **启动系统**：
   ```bash
   # 使用Docker Compose启动系统
   docker-compose up -d
   
   # 或使用提供的启动脚本
   ./deploy.sh  # Linux/macOS
   deploy.bat   # Windows
   ```

5. **验证服务可访问性**：
   访问 `http://localhost:8000` 确认系统已正常启动。

## 3. 功能测试执行指南

### 3.1 使用自动化测试脚本

1. **运行功能测试脚本**：
   ```bash
   # 默认测试本地服务
   python 功能测试脚本.py
   
   # 指定API基础URL
   python 功能测试脚本.py --url http://server-ip:port
   ```

2. **查看测试结果**：
   - 测试结果日志: `功能测试结果.log`
   - 测试结果图表: `功能测试结果.png`
   - 测试报告JSON: `功能测试报告.json`

### 3.2 手动功能测试

#### 3.2.1 API接口测试

1. **健康检查接口**：
   - 访问`http://localhost:8000/health`
   - 验证返回状态码为200
   - 验证返回数据中包含`"status": "healthy"`

2. **排放数据接口**：
   - 访问`http://localhost:8000/api/emissions`
   - 验证返回的数据格式正确
   - 尝试添加过滤参数，如`?type=SO2&start_date=2023-01-01&end_date=2023-01-07`
   - 验证分页功能，如`?page=1&page_size=10`

3. **排放预测接口**：
   - 使用Postman或类似工具，向`http://localhost:8000/predict`发送POST请求
   - 准备有效的特征数据作为请求体
   - 验证返回的预测结果格式正确
   - 尝试不同模型类型（LSTM, GRU）的预测

4. **自然语言查询接口**：
   - 向`http://localhost:8000/api/nlp_query`发送POST请求
   - 使用样例查询如"最近24小时的SO2平均排放浓度是多少?"
   - 验证返回的答案是否合理

#### 3.2.2 前端功能测试

1. **首页**：
   - 检查实时数据概览是否正确显示
   - 验证机组排放状态表格是否加载
   - 测试数据刷新功能

2. **数据看板**：
   - 检查各个图表是否正确渲染
   - 测试不同污染物类型的切换
   - 测试不同机组的切换
   - 测试日期范围选择功能

3. **排放预测页面**：
   - 测试加载当前数据功能
   - 测试手动输入特征数据
   - 测试预测功能并查看结果
   - 测试不同预测时间段的切换

4. **自然语言查询页面**：
   - 测试输入不同的查询语句
   - 验证查询结果的正确性
   - 测试查询历史是否保存

5. **语音识别页面**：
   - 测试麦克风权限请求
   - 测试语音录制功能
   - 测试语音转文字功能
   - 测试语音查询功能

### 3.3 功能测试结果记录

使用`综合测试报告模板.md`中的功能测试部分记录测试结果，包括：
- 测试用例总数和通过率
- API接口测试结果
- 前端功能测试结果
- 发现的主要缺陷和问题

## 4. 性能测试执行指南

### 4.1 使用自动化测试脚本

1. **运行性能测试脚本**：
   ```bash
   # 默认测试本地服务
   python 性能测试脚本.py
   
   # 指定参数
   python 性能测试脚本.py --url http://server-ip:port --users 1,5,10,25,50 --duration 30 --interval 1.0 --monitor-duration 60
   ```

2. **查看测试结果**：
   - 测试结果日志: `性能测试结果.log`
   - API响应时间图表: `性能测试_health.png`, `性能测试_emissions.png`等
   - 系统资源使用情况图表: `系统资源使用情况.png`
   - 综合性能报告图表: `性能测试综合报告.png`
   - 测试报告JSON: `性能测试报告.json`

### 4.2 手动性能测试

#### 4.2.1 使用JMeter或Locust进行负载测试

1. **安装JMeter或Locust**：
   ```bash
   # 安装Locust
   pip install locust
   ```

2. **创建测试计划**：
   - 配置HTTP请求（目标服务器、端口、路径）
   - 设置线程数（模拟用户数）
   - 设置循环次数或持续时间
   - 添加结果监听器

3. **运行负载测试**：
   ```bash
   # 使用Locust运行测试
   locust -f locustfile.py --host=http://localhost:8000
   ```

4. **监控系统资源**：
   - 使用Docker stats监控容器资源
   ```bash
   docker stats
   ```
   - 使用top/htop监控系统资源
   ```bash
   htop
   ```

### 4.3 性能测试结果记录

使用`综合测试报告模板.md`中的性能测试部分记录测试结果，包括：
- API响应时间在不同并发用户数下的表现
- 系统资源使用情况
- 长时间运行的稳定性
- 性能瓶颈分析

## 5. 用户体验测试执行指南

### 5.1 测试准备

1. **选择测试参与者**：
   - 确保参与者来自不同背景（技术、业务、管理）
   - 理想参与人数为5-10人
   - 确保参与者事先了解测试目的

2. **准备测试环境**：
   - 确保系统正常运行
   - 准备测试用的客户端设备
   - 打印`用户体验测试表单.md`

3. **制定测试任务**：
   - 确保表单中的测试任务覆盖系统的主要功能
   - 为每个任务设定合理的完成时间

### 5.2 测试执行

1. **测试简介**：
   - 向参与者介绍系统的基本情况和功能
   - 说明测试的目的和方法
   - 强调记录真实感受和问题的重要性

2. **引导参与者完成任务**：
   - 让参与者尝试独立完成表单中的任务
   - 记录参与者完成每个任务的时间
   - 观察并记录参与者遇到的困难和问题
   - 不要提前告知操作方法，除非参与者完全无法继续

3. **收集反馈**：
   - 让参与者填写`用户体验测试表单.md`
   - 进行面对面访谈，收集更详细的反馈
   - 记录参与者的建议和意见

### 5.3 用户体验测试结果分析

1. **整理测试数据**：
   - 计算各评分项的平均分、最高分、最低分和标准差
   - 统计各任务的完成情况和平均完成时间
   - 整理参与者的反馈和建议

2. **分析问题和改进方向**：
   - 找出评分较低的项目
   - 分析完成率低的任务
   - 汇总参与者反馈的主要问题
   - 提出改进建议

3. **记录测试结果**：
   使用`综合测试报告模板.md`中的用户体验测试部分记录结果

## 6. 综合测试报告生成

1. **收集所有测试结果**：
   - 功能测试报告
   - 性能测试报告
   - 用户体验测试结果

2. **填写综合测试报告**：
   按照`综合测试报告模板.md`的结构填写完整的测试报告，包括：
   - 测试概述
   - 功能测试结果
   - 性能测试结果
   - 用户体验测试结果
   - 综合评估
   - 问题汇总与改进建议
   - 测试结论

3. **报告审核**：
   - 由测试负责人、开发负责人、项目经理和质量保证人员审核报告
   - 收集审核意见并修订报告
   - 最终确定测试报告

## 7. 常见问题与解决方法

### 7.1 环境问题

1. **Docker容器无法启动**：
   - 检查Docker和Docker Compose安装是否正确
   - 检查系统资源是否足够
   - 查看Docker日志了解具体错误

2. **API无法访问**：
   - 确认容器已正常启动
   - 检查端口映射是否正确
   - 检查网络连接和防火墙设置

### 7.2 测试脚本问题

1. **测试脚本执行错误**：
   - 确认已安装所有依赖库
   - 检查Python版本是否兼容
   - 检查脚本中的API路径是否正确

2. **性能测试结果异常**：
   - 检查测试环境是否有其他程序占用资源
   - 尝试调整测试参数（并发用户数、请求间隔）
   - 确认系统配置符合要求

### 7.3 用户体验测试问题

1. **参与者难以理解测试任务**：
   - 提供更详细的任务描述
   - 确保任务与实际业务场景相符
   - 提供适当的上下文信息

2. **反馈意见不一致**：
   - 增加样本数量
   - 按用户角色分类分析反馈
   - 关注反馈的共性问题

## 8. 附录

### 8.1 测试脚本参数说明

#### 功能测试脚本参数

| 参数 | 描述 | 默认值 |
|------|------|--------|
| --url | API基础URL | http://localhost:8000 |

#### 性能测试脚本参数

| 参数 | 描述 | 默认值 |
|------|------|--------|
| --url | API基础URL | http://localhost:8000 |
| --users | 并发用户数列表 | 1,5,10,25,50 |
| --duration | 每个测试的持续时间(秒) | 30 |
| --interval | 请求间隔时间(秒) | 1.0 |
| --monitor-duration | 系统资源监控持续时间(秒) | 60 |

### 8.2 测试数据示例

#### 排放预测API请求体示例

```json
{
  "features": [
    [75.0, 25.0, 60.0, 3.5, 120.0, 15, 20, 4, 2023, 2, 20.0, 40.0, 8.0]
  ],
  "model_type": "lstm"
}
```

#### 自然语言查询API请求体示例

```json
{
  "query": "最近24小时的SO2平均排放浓度是多少?",
  "mode": "text"
}
```

### 8.3 相关资源链接

- [Docker官方文档](https://docs.docker.com/)
- [JMeter官方文档](https://jmeter.apache.org/usermanual/index.html)
- [Locust官方文档](https://docs.locust.io/en/stable/)
- [Python Requests库文档](https://docs.python-requests.org/en/latest/)
- [Pandas官方文档](https://pandas.pydata.org/docs/)
- [Matplotlib官方文档](https://matplotlib.org/stable/contents.html) 